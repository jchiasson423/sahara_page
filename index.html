<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparateur d'Exp√©ditions √† Merzouga</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Dune Harmony -->
    <!-- Application Structure Plan: L'application est con√ßue comme un tableau de bord interactif √† page unique pour aider l'utilisateur √† choisir une exp√©dition dans le d√©sert. Plut√¥t qu'un long document, l'information est segment√©e en trois vues accessibles par des onglets : 1) Un 'Comparateur d'Agences' interactif (vue par d√©faut) avec des cartes pour chaque tour, des filtres, et un graphique comparatif des prix. 2) Une vue 'Top 3 Recommandations' mettant en √©vidence les meilleurs choix. 3) Une vue 'Conseils de Voyage' avec des informations pratiques sous forme d'accord√©on. Cette structure est choisie pour sa convivialit√© et son orientation vers la t√¢che principale de l'utilisateur : comparer et d√©cider. Elle transforme la lecture passive en exploration active. -->
    <!-- Visualization & Content Choices: 
        - Rapport -> Objectif -> Visualisation/Pr√©sentation -> Interaction -> Justification
        - Tableau comparatif -> Comparer efficacement -> Grille de cartes responsive (HTML/Tailwind) -> Boutons de tri (prix, note) -> Plus intuitif et adaptable aux mobiles qu'un tableau statique.
        - Prix des tours -> Comparer les co√ªts -> Graphique √† barres horizontales (Chart.js) -> Info-bulles au survol -> Visualisation imm√©diate des diff√©rences de prix, crit√®re cl√© pour l'utilisateur.
        - Services cl√©s (tente, musique, nourriture) -> Informer rapidement -> Ic√¥nes Unicode par carte (‚õ∫,üé∂,üçΩÔ∏è) -> Aucun -> Permet une identification visuelle instantan√©e des prestations incluses.
        - Recommandations -> Guider la d√©cision -> Section d√©di√©e avec des cartes mises en avant -> Aucun -> Focalise l'attention de l'utilisateur sur les options les plus pertinentes.
        - Conseils pratiques -> Organiser l'information -> Accord√©on (HTML/JS) -> Clic pour d√©plier/replier -> Garde la section propre et √©vite une longue liste, am√©liorant la lisibilit√©.
        - CONFIRMATION: Aucun graphique SVG ou Mermaid JS n'est utilis√©. Toutes les visualisations sont r√©alis√©es avec Chart.js (Canvas) ou des √©l√©ments HTML/CSS/Unicode. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF5; 
            color: #4B3F36;
        }
        .active-tab {
            border-bottom-color: #D97706; 
            color: #D97706;
            font-weight: 700;
        }
        .tab-btn {
            border-bottom: 2px solid transparent;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
                max-height: 60vh;
            }
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-amber-900">Votre Aventure Saharienne √† Merzouga</h1>
            <p class="mt-4 text-lg text-stone-700 max-w-3xl mx-auto">Un outil interactif pour choisir votre exp√©dition de 3 jours au d√©part de Marrakech, selon vos envies d'authenticit√© et votre budget.</p>
        </header>

        <div class="bg-amber-50 rounded-xl p-6 mb-12 border border-amber-200">
             <h2 class="text-2xl font-bold text-amber-800 mb-3 text-center">R√©sum√© de votre recherche</h2>
             <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 text-center">
                <div class="bg-white p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">üìÖ</span>
                    <p class="font-semibold mt-1">3 Jours / 2 Nuits</p>
                </div>
                <div class="bg-white p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">‚õ∫</span>
                    <p class="font-semibold mt-1">Nuit en Bivouac</p>
                </div>
                <div class="bg-white p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">üé∂</span>
                    <p class="font-semibold mt-1">Musique Berb√®re</p>
                </div>
                <div class="bg-white p-3 rounded-lg shadow-sm">
                    <span class="text-2xl">üçΩÔ∏è</span>
                    <p class="font-semibold mt-1">Repas Typiques</p>
                </div>
                <div class="bg-white p-3 rounded-lg shadow-sm col-span-2 lg:col-span-1">
                    <span class="text-2xl">üí∏</span>
                    <p class="font-semibold mt-1">Budget Mod√©r√©</p>
                </div>
            </div>
        </div>

        <main>
            <div class="border-b border-gray-200 mb-8">
                <nav class="-mb-px flex justify-center space-x-4 md:space-x-8" aria-label="Tabs">
                    <button id="tab-comparator" class="tab-btn whitespace-nowrap py-4 px-1 text-base font-medium active-tab">Comparateur d'Agences</button>
                    <button id="tab-recommendations" class="tab-btn whitespace-nowrap py-4 px-1 text-base font-medium">Top 3 Recommandations</button>
                    <button id="tab-tips" class="tab-btn whitespace-nowrap py-4 px-1 text-base font-medium">Conseils de Voyage</button>
                </nav>
            </div>

            <div id="view-comparator">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-amber-900">Comparez les Exp√©ditions</h2>
                    <p class="mt-2 text-stone-600 max-w-2xl mx-auto">Utilisez le graphique et les filtres ci-dessous pour trouver le circuit qui vous convient. Toutes les options incluent une nuit en tente, une balade √† chameau et le transport depuis Marrakech.</p>
                </div>
                
                <div class="mb-12">
                    <div class="chart-container">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>

                <div class="flex flex-wrap justify-center gap-2 mb-8">
                    <span class="self-center mr-2 font-semibold">Trier par:</span>
                    <button id="sort-price-asc" class="bg-white hover:bg-amber-100 text-amber-800 font-semibold py-2 px-4 border border-amber-200 rounded-lg shadow-sm">Prix (croissant)</button>
                    <button id="sort-price-desc" class="bg-white hover:bg-amber-100 text-amber-800 font-semibold py-2 px-4 border border-amber-200 rounded-lg shadow-sm">Prix (d√©croissant)</button>
                    <button id="sort-rating-desc" class="bg-white hover:bg-amber-100 text-amber-800 font-semibold py-2 px-4 border border-amber-200 rounded-lg shadow-sm">Note (√©lev√©e)</button>
                </div>
                
                <div id="tours-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
            </div>

            <div id="view-recommendations" class="hidden">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-amber-900">Nos 3 Meilleures Recommandations</h2>
                    <p class="mt-2 text-stone-600 max-w-2xl mx-auto">Bas√© sur une analyse compl√®te de vos crit√®res, voici les trois options qui se distinguent par leur rapport qualit√©/prix, les avis des voyageurs et la richesse de l'exp√©rience.</p>
                </div>
                <div id="recommendations-grid" class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-stretch">
                </div>
            </div>

            <div id="view-tips" class="hidden">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-amber-900">Conseils pour une Aventure R√©ussie</h2>
                    <p class="mt-2 text-stone-600 max-w-2xl mx-auto">Quelques informations pratiques pour vous pr√©parer au mieux √† votre immersion dans le Sahara.</p>
                </div>
                <div id="tips-accordion" class="max-w-3xl mx-auto space-y-4">
                </div>
            </div>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const toursData = [
                {
                    id: 1,
                    title: "Excursion Dunes de Merzouga (Groupe)",
                    agency: "Traces Berb√®res Nature & Aventure",
                    price: 132,
                    rating: 4.8,
                    reviewsCount: 'Nombreux',
                    link: "https://excursionmarrakech-maroc.com/detail/4/excursion-dunes-de-merzouga-et-vallee-de-dades/5",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "Un tarif de groupe tr√®s attractif avec une excellente r√©putation des guides. Offre une politique d'annulation flexible et un contact direct avec une agence locale exp√©riment√©e.",
                    isRecommendation: 1
                },
                {
                    id: 2,
                    title: "Merzouga 3-Day Desert Safari with Food",
                    agency: "via GetYourGuide",
                    price: 151,
                    rating: 4.6,
                    reviewsCount: '8900+',
                    link: "https://www.getyourguide.com",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "Extr√™mement populaire avec des milliers d'avis positifs. La musique berb√®re est explicitement mentionn√©e (tambours Tam Tam). R√©servation facile et fiable via une plateforme reconnue.",
                    isRecommendation: 2
                },
                {
                    id: 3,
                    title: "Merzouga Desert Tour 3 Days",
                    agency: "Desert Tour Morocco (via GetYourGuide)",
                    price: 145,
                    rating: 4.5,
                    reviewsCount: '26+',
                    link: "https://www.getyourguide.com",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "L'une des options les plus abordables. Inclut explicitement la musique, une tente priv√©e au camp et m√™me du sandboarding pour une touche d'aventure suppl√©mentaire.",
                    isRecommendation: 3
                },
                {
                    id: 4,
                    title: "Circuit en groupe de 3 jours",
                    agency: "Marrakech Desert Trips",
                    price: 140,
                    rating: 4.4,
                    reviewsCount: '1200+',
                    link: "https://www.marrakech-desert-trips.com/fr/",
                    cancellable: false,
                    booking: "Contact direct",
                    music: true,
                    food: true,
                    summary: "Agence locale sp√©cialis√©e, n√©cessite un contact direct pour confirmer les d√©tails et la politique d'annulation. Bon point de d√©part pour une offre personnalis√©e.",
                    isRecommendation: 0
                },
                {
                    id: 5,
                    title: "3 Days Tour to Merzouga with Luxury Camp",
                    agency: "Desert Family Tour (via GetYourGuide)",
                    price: 186,
                    rating: 4.5,
                    reviewsCount: '4+',
                    link: "https://www.getyourguide.com",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "Option l√©g√®rement plus ch√®re avec un camp 'de luxe'. Id√©al si vous souhaitez un peu plus de confort tout en gardant l'exp√©rience authentique.",
                    isRecommendation: 0
                },
                {
                    id: 6,
                    title: "Sahara Desert Merzouga Low Cost Tour",
                    agency: "via Viator",
                    price: 192,
                    rating: 4.3,
                    reviewsCount: '3+',
                    link: "https://www.viator.com",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "Option 'Low Cost' sur Viator, le prix de base semble plus √©lev√© mais peut inclure d'autres services. √Ä v√©rifier sur la plateforme.",
                    isRecommendation: 0
                },
                {
                    id: 7,
                    title: "3 Days Desert Tour & Camel Trek",
                    agency: "Hdida Tours (via Viator)",
                    price: 159,
                    rating: 4.8,
                    reviewsCount: '6+',
                    link: "https://www.viator.com",
                    cancellable: true,
                    booking: "En ligne",
                    music: true,
                    food: true,
                    summary: "Excellents avis sur le service de l'op√©rateur local Hdida Tours. Une option fiable et tr√®s bien not√©e sur Viator.",
                    isRecommendation: 0
                }
            ];

            const tipsData = [
                {
                    title: "Quoi Emporter ?",
                    content: "Pr√©voyez des v√™tements pour des temp√©ratures extr√™mes : chaud le jour, froid la nuit. N'oubliez pas cr√®me solaire, chapeau, lunettes de soleil, et une √©charpe (ch√®che). Des chaussures de marche confortables et une batterie externe sont aussi recommand√©es."
                },
                {
                    title: "Hydratation et Sant√©",
                    content: "Buvez beaucoup d'eau pour √©viter la d√©shydratation. Une petite trousse de premiers secours avec les essentiels (pansements, d√©sinfectant, etc.) est toujours une bonne id√©e."
                },
                {
                    title: "Pourboires et Argent",
                    content: "Il est d'usage au Maroc de laisser un pourboire aux guides, chauffeurs et personnel de camp si vous √™tes satisfait du service. Pr√©voyez un peu d'argent liquide pour cela et pour les d√©penses personnelles comme les boissons ou les d√©jeuners."
                },
                {
                    title: "Respect Culturel et Photographie",
                    content: "Adoptez une attitude respectueuse envers les coutumes locales. Demandez toujours la permission avant de prendre des personnes en photo. Un simple sourire et un geste sont souvent suffisants."
                },
                {
                    title: "D√©connexion Num√©rique",
                    content: "La couverture r√©seau est tr√®s limit√©e, voire inexistante, au c≈ìur du d√©sert. C'est l'occasion parfaite de vous d√©connecter et de vous immerger pleinement dans l'instant pr√©sent."
                }
            ];

            const toursGrid = document.getElementById('tours-grid');
            const recommendationsGrid = document.getElementById('recommendations-grid');
            const tipsAccordion = document.getElementById('tips-accordion');

            const renderStars = (rating) => {
                const fullStars = Math.floor(rating);
                const halfStar = rating % 1 >= 0.5 ? 1 : 0;
                const emptyStars = 5 - fullStars - halfStar;
                return '‚òÖ'.repeat(fullStars) + (halfStar ? '¬Ω' : '') + '‚òÜ'.repeat(emptyStars);
            };

            const renderTours = (tours, container, isRecommendation) => {
                container.innerHTML = '';
                tours.forEach(tour => {
                    const card = document.createElement('div');
                    card.className = `bg-white rounded-xl shadow-md overflow-hidden flex flex-col transition-transform transform hover:-translate-y-1 border ${isRecommendation ? 'border-amber-400' : 'border-gray-200'}`;
                    
                    let recommendationBadge = '';
                    if (isRecommendation) {
                        recommendationBadge = `<div class="absolute top-0 left-0 bg-amber-600 text-white font-bold py-1 px-3 rounded-br-lg z-10">Recommandation #${tour.isRecommendation}</div>`;
                    }

                    card.innerHTML = `
                        <div class="relative">
                            ${recommendationBadge}
                            <div class="p-6">
                                <div class="uppercase tracking-wide text-sm text-amber-600 font-bold">${tour.agency}</div>
                                <h3 class="block mt-1 text-xl leading-tight font-bold text-black">${tour.title}</h3>
                                <div class="mt-4 flex justify-between items-center">
                                    <p class="text-3xl font-bold text-amber-800">${tour.price}<span class="text-base font-normal"> CAD</span></p>
                                    <div class="text-right">
                                        <div class="text-lg text-amber-500">${renderStars(tour.rating)}</div>
                                        <p class="text-sm text-gray-600">${tour.rating.toFixed(1)}/5 (${tour.reviewsCount} avis)</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="p-6 pt-0 mt-auto">
                            ${isRecommendation ? `<p class="text-stone-600 mb-4">${tour.summary}</p>` : ''}
                            <div class="grid grid-cols-2 gap-3 text-sm text-stone-700 mb-4">
                                <span class="flex items-center">
                                    <span class="text-green-600 mr-2">‚úîÔ∏è</span> R√©s. ${tour.booking}
                                </span>
                                <span class="flex items-center">
                                    <span class="${tour.cancellable ? 'text-green-600' : 'text-red-500'} mr-2">${tour.cancellable ? '‚úîÔ∏è' : '‚ùå'}</span> Annulation gratuite
                                </span>
                                 <span class="flex items-center">
                                    <span class="text-xl mr-2">üé∂</span> Musique berb√®re
                                </span>
                                 <span class="flex items-center">
                                    <span class="text-xl mr-2">üçΩÔ∏è</span> Repas typiques
                                </span>
                            </div>
                            <a href="${tour.link}" target="_blank" class="block w-full text-center bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                                V√©rifier & R√©server
                            </a>
                        </div>
                    `;
                    container.appendChild(card);
                });
            };

            const renderTips = () => {
                tipsData.forEach(tip => {
                    const tipDiv = document.createElement('div');
                    tipDiv.className = 'border border-gray-200 rounded-lg bg-white';
                    tipDiv.innerHTML = `
                        <button class="accordion-button w-full flex justify-between items-center text-left p-4 font-semibold text-stone-800">
                            <span>${tip.title}</span>
                            <span class="transform transition-transform duration-300">‚ñº</span>
                        </button>
                        <div class="accordion-content px-4 pb-4 text-stone-600">
                            <p>${tip.content}</p>
                        </div>
                    `;
                    tipsAccordion.appendChild(tipDiv);
                });

                document.querySelectorAll('.accordion-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const arrow = button.querySelector('span:last-child');
                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            arrow.style.transform = 'rotate(0deg)';
                        } else {
                            document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                            document.querySelectorAll('.accordion-button span:last-child').forEach(a => a.style.transform = 'rotate(0deg)');
                            content.style.maxHeight = content.scrollHeight + "px";
                            arrow.style.transform = 'rotate(180deg)';
                        }
                    });
                });
            };
            
            const sortTours = (criteria) => {
                let sortedTours = [...toursData];
                switch(criteria) {
                    case 'price-asc':
                        sortedTours.sort((a, b) => a.price - b.price);
                        break;
                    case 'price-desc':
                        sortedTours.sort((a, b) => b.price - a.price);
                        break;
                    case 'rating-desc':
                        sortedTours.sort((a, b) => b.rating - a.rating);
                        break;
                }
                renderTours(sortedTours, toursGrid, false);
            };

            document.getElementById('sort-price-asc').addEventListener('click', () => sortTours('price-asc'));
            document.getElementById('sort-price-desc').addEventListener('click', () => sortTours('price-desc'));
            document.getElementById('sort-rating-desc').addEventListener('click', () => sortTours('rating-desc'));

            const tabButtons = document.querySelectorAll('.tab-btn');
            const views = {
                'tab-comparator': document.getElementById('view-comparator'),
                'tab-recommendations': document.getElementById('view-recommendations'),
                'tab-tips': document.getElementById('view-tips')
            };

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active-tab'));
                    button.classList.add('active-tab');

                    Object.values(views).forEach(view => view.classList.add('hidden'));
                    views[button.id].classList.remove('hidden');
                });
            });

            const createChart = () => {
                const ctx = document.getElementById('priceChart').getContext('2d');
                const sortedData = [...toursData].sort((a, b) => a.price - b.price);

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: sortedData.map(t => t.title.length > 30 ? t.title.substring(0, 30) + '...' : t.title),
                        datasets: [{
                            label: 'Prix par personne (CAD)',
                            data: sortedData.map(t => t.price),
                            backgroundColor: 'rgba(217, 119, 6, 0.7)',
                            borderColor: 'rgba(217, 119, 6, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    title: (context) => {
                                        const index = context[0].dataIndex;
                                        return sortedData[index].title;
                                    },
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.x !== null) {
                                            label += new Intl.NumberFormat('fr-CA', { style: 'currency', currency: 'CAD' }).format(context.parsed.x);
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Prix (CAD)'
                                }
                            }
                        }
                    }
                });
            };

            sortTours('price-asc');
            renderTours(toursData.filter(t => t.isRecommendation > 0).sort((a,b) => a.isRecommendation - b.isRecommendation), recommendationsGrid, true);
            renderTips();
            createChart();
        });
    </script>
</body>
</html>
